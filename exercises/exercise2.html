<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 2: Build a Registration Form - HTML Master</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Exercise Page Styles (same system as Exercise 1) */
        .exercise-container{max-width:1200px;margin:100px auto 50px;padding:0 20px}
        .exercise-header{background:linear-gradient(135deg,#f39c12 0%,#e67e22 100%);color:#fff;border-radius:12px;padding:40px;margin-bottom:40px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .exercise-badge{display:inline-block;padding:8px 20px;background:rgba(255,255,255,.2);border-radius:20px;font-size:.9rem;margin-bottom:15px}
        .exercise-title{font-size:2.5rem;margin:10px 0 20px}
        .exercise-meta{display:flex;gap:30px;margin-top:20px;flex-wrap:wrap}
        .meta-item{display:flex;align-items:center;gap:10px}
        .meta-item i{font-size:1.2rem}
        .exercise-content{display:grid;grid-template-columns:1fr 1fr;gap:40px;margin-top:40px}
        @media (max-width:992px){.exercise-content{grid-template-columns:1fr}}
        .instructions-card{background:#fff;border-radius:12px;padding:30px;box-shadow:0 5px 15px rgba(0,0,0,.1)}
        .instructions-card h3{color:#2c3e50;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #f39c12;display:flex;align-items:center;gap:10px}
        .requirements-list{list-style:none;margin:20px 0}
        .requirements-list li{padding:10px 0;border-bottom:1px solid #eee;display:flex;align-items:center;gap:10px}
        .requirements-list li:last-child{border-bottom:none}
        .requirements-list i{color:#2ecc71}
        .example-output{background:#fff7e6;padding:20px;border-radius:8px;border-left:4px solid #f39c12;margin:20px 0}
        .exercise-editor{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,.1)}
        .editor-header{background:#2c3e50;color:#fff;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}
        .editor-header h3{margin:0;font-size:1.1rem}
        .editor-actions{display:flex;gap:10px}
        .editor-action-btn{padding:8px 15px;border:none;border-radius:5px;cursor:pointer;font-size:.9rem;display:flex;align-items:center;gap:5px;transition:all .3s ease}
        .editor-action-btn.run{background:#2ecc71;color:#fff}
        .editor-action-btn.check{background:#3498db;color:#fff}
        .editor-action-btn.reset{background:#95a5a6;color:#fff}
        .editor-action-btn.solution{background:#9b59b6;color:#fff}
        .editor-action-btn:hover{transform:translateY(-2px);box-shadow:0 5px 10px rgba(0,0,0,.2)}
        .editor-body{display:grid;grid-template-columns:1fr 1fr;min-height:520px}
        @media (max-width:768px){.editor-body{grid-template-columns:1fr}}
        .code-editor-area{border-right:1px solid #ddd}
        @media (max-width:768px){.code-editor-area{border-right:none;border-bottom:1px solid #ddd}}
        textarea{width:100%;height:100%;border:none;padding:20px;font-family:'Courier New',monospace;font-size:14px;line-height:1.5;resize:none;outline:none;background:#f8f9fa}
        .output-area{background:#fff;padding:20px}
        .output-area h4{margin:0 0 15px;color:#2c3e50}
        iframe{width:100%;height:430px;border:1px solid #ddd;border-radius:5px}
        .feedback-message{margin-top:20px;padding:20px;border-radius:8px;display:none}
        .feedback-message.success{background:#d4edda;border:1px solid #c3e6cb;color:#155724}
        .feedback-message.warning{background:#fff3cd;border:1px solid #ffeeba;color:#856404}
        .success-message{background:#d4edda;border:1px solid #c3e6cb;color:#155724;padding:20px;border-radius:8px;margin-top:20px;display:none}
        .next-exercise{margin-top:30px;text-align:center}
        .next-exercise a{display:inline-flex;align-items:center;gap:10px;padding:12px 25px;background:#f39c12;color:#fff;text-decoration:none;border-radius:25px;font-weight:600;transition:all .3s ease;opacity:.6;cursor:not-allowed}
        .next-exercise a:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,.2)}
        .progress-steps{display:flex;justify-content:center;margin:30px 0;gap:20px}
        .progress-step{display:flex;align-items:center;gap:10px}
        .step-circle{width:35px;height:35px;border-radius:50%;background:#ddd;display:flex;align-items:center;justify-content:center;font-weight:700;color:#666}
        .step-circle.active{background:#f39c12;color:#fff}
        .step-circle.completed{background:#2ecc71;color:#fff}
        .step-line{width:40px;height:3px;background:#ddd}
        .step-line.completed{background:#2ecc71}
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-code"></i>
                <span>HTML Master</span>
            </div>
            <ul class="nav-menu">
                <li><a href="../index.html#exercises"><i class="fas fa-arrow-left"></i> Back to Exercises</a></li>
                <li><a href="../index.html"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="../arcade.html"><i class="fas fa-gamepad"></i> Arcade</a></li>
            </ul>
        </div>
    </nav>

    <div class="exercise-container">
        <div class="exercise-header">
            <span class="exercise-badge"><i class="fas fa-layer-group"></i> Medium</span>
            <h1 class="exercise-title">Exercise 2: Build a Registration Form</h1>
            <p>Create a form using correct input types and HTML5 validation attributes.</p>
            <div class="exercise-meta">
                <div class="meta-item"><i class="far fa-clock"></i> 15 minutes</div>
                <div class="meta-item"><i class="fas fa-star"></i> 25 points</div>
                <div class="meta-item"><i class="fas fa-check-circle"></i> HTML5 Validation</div>
            </div>
        </div>

        <div class="progress-steps" aria-label="Exercise progress">
            <div class="progress-step"><div class="step-circle completed">1</div><span>Basics</span></div>
            <div class="step-line completed"></div>
            <div class="progress-step"><div class="step-circle active">2</div><span>Forms</span></div>
            <div class="step-line"></div>
            <div class="progress-step"><div class="step-circle">3</div><span>Layout</span></div>
        </div>

        <div class="exercise-content">
            <div class="instructions-card">
                <h3><i class="fas fa-list-check"></i> Exercise Instructions</h3>

                <p><strong>Goal:</strong> Build a registration form that uses the correct input types and validation.</p>

                <h4>Requirements</h4>
                <ul class="requirements-list">
                    <li><i class="fas fa-check-circle"></i> Use a <code>&lt;form&gt;</code> with <code>method="POST"</code></li>
                    <li><i class="fas fa-check-circle"></i> Add <strong>labels</strong> for every input</li>
                    <li><i class="fas fa-check-circle"></i> Fields: Full Name, Email, Password, Confirm Password</li>
                    <li><i class="fas fa-check-circle"></i> Make all fields <code>required</code></li>
                    <li><i class="fas fa-check-circle"></i> Use correct types: <code>text</code>, <code>email</code>, <code>password</code></li>
                    <li><i class="fas fa-check-circle"></i> Password: <code>minlength="8"</code></li>
                    <li><i class="fas fa-check-circle"></i> Submit button with text: <strong>Register</strong></li>
                </ul>

                <h4>Example output (visual)</h4>
                <div class="example-output">
                    <form>
                        <label>Full Name <input type="text" required></label><br>
                        <label>Email <input type="email" required></label><br>
                        <label>Password <input type="password" minlength="8" required></label><br>
                        <label>Confirm Password <input type="password" minlength="8" required></label><br>
                        <button type="submit">Register</button>
                    </form>
                </div>
            </div>

            <div class="exercise-editor">
                <div class="editor-header">
                    <h3><i class="fas fa-code"></i> Code Editor</h3>
                    <div class="editor-actions">
                        <button class="editor-action-btn run" onclick="runCode()"><i class="fas fa-play"></i> Run</button>
                        <button class="editor-action-btn check" onclick="checkSolution()"><i class="fas fa-check"></i> Check</button>
                        <button class="editor-action-btn reset" onclick="resetCode()"><i class="fas fa-rotate-left"></i> Reset</button>
                        <button class="editor-action-btn solution" onclick="showSolution()"><i class="fas fa-lightbulb"></i> Solution</button>
                    </div>
                </div>

                <div class="editor-body">
                    <div class="code-editor-area">
                        <textarea id="exerciseCode" spellcheck="false"></textarea>
                    </div>
                    <div class="output-area">
                        <h4><i class="fas fa-display"></i> Output</h4>
                        <iframe id="outputFrame" title="Exercise output"></iframe>
                        <div id="feedbackMessage" class="feedback-message"></div>
                        <div id="successMessage" class="success-message">
                            <h4><i class="fas fa-trophy"></i> Nice!</h4>
                            <p>You built a valid form. You can continue to Exercise 3.</p>
                        </div>
                        <div class="next-exercise">
                            <a id="nextExerciseBtn" href="#" onclick="goToNextExercise(event)">
                                <i class="fas fa-lock"></i> Complete to unlock Exercise 3
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer" style="margin-top:50px;">
        <div class="footer-bottom"><p>&copy; 2024 HTML Master. Practice makes progress.</p></div>
    </footer>

    <script>
        const starterCode = `<!DOCTYPE html>
<html>
<head>
    <title>Registration</title>
</head>
<body>
    <!-- Build your form here -->

</body>
</html>`;

        const solutionCode = `<!DOCTYPE html>
<html>
<head>
    <title>Registration</title>
</head>
<body>
    <h1>Register</h1>
    <form method="POST">
        <label>
            Full Name
            <input type="text" name="name" placeholder="Your full name" required>
        </label>
        <br>
        <label>
            Email
            <input type="email" name="email" placeholder="you@example.com" required>
        </label>
        <br>
        <label>
            Password
            <input type="password" name="password" minlength="8" placeholder="Min 8 characters" required>
        </label>
        <br>
        <label>
            Confirm Password
            <input type="password" name="confirm" minlength="8" placeholder="Repeat password" required>
        </label>
        <br>
        <button type="submit">Register</button>
    </form>
</body>
</html>`;

        function resetCode(){
            document.getElementById('exerciseCode').value = starterCode;
            hideFeedback();
            runCode();
        }

        function showSolution(){
            if (confirm('View the example solution? This will replace your current code.')) {
                document.getElementById('exerciseCode').value = solutionCode;
                hideFeedback();
                runCode();
            }
        }

        function runCode(){
            const iframe = document.getElementById('outputFrame');
            const code = document.getElementById('exerciseCode').value;
            const doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.open();
            doc.write(code);
            doc.close();
        }

        function checkSolution(){
            const userCode = document.getElementById('exerciseCode').value;
            const code = userCode.toLowerCase();
            const feedback = document.getElementById('feedbackMessage');
            const successMsg = document.getElementById('successMessage');

            let errors = [];
            let warnings = [];
            let score = 0;
            const maxScore = 12;

            // Structure checks
            if (code.includes('<form') && code.includes('</form>')) score += 2;
            else errors.push('Missing <form>...</form>');

            if (code.includes('method="post"') || code.includes("method='post'")) score += 2;
            else errors.push('Form must use method="POST"');

            // Inputs
            const hasText = code.includes('type="text"') || code.includes("type='text'");
            const hasEmail = code.includes('type="email"') || code.includes("type='email'");
            const passwordCount = (code.match(/type\s*=\s*['\"]password['\"]/g) || []).length;

            if (hasText) score += 1; else errors.push('Missing input type="text" for Full Name');
            if (hasEmail) score += 2; else errors.push('Missing input type="email"');
            if (passwordCount >= 2) score += 2; else errors.push('Need TWO password inputs (password + confirm)');

            // required
            const requiredCount = (code.match(/\srequired\b/g) || []).length;
            if (requiredCount >= 4) score += 2;
            else warnings.push(`Make all fields required (found ${requiredCount})`);

            // minlength
            if (code.includes('minlength="8"') || code.includes("minlength='8'")) score += 2;
            else warnings.push('Add minlength="8" to password fields');

            // labels
            const labelCount = (code.match(/<label/g) || []).length;
            if (labelCount >= 4) score += 1;
            else warnings.push(`Add labels for all inputs (found ${labelCount})`);

            // submit button
            if (code.includes('<button') && code.includes('register')) score += 2;
            else warnings.push('Add a submit button with text "Register"');

            // Render feedback
            if (errors.length === 0 && warnings.length === 0) {
                feedback.className = 'feedback-message success';
                feedback.innerHTML = `
                    <h4><i class="fas fa-check-circle"></i> Perfect!</h4>
                    <p>All requirements met. Score: ${score}/${maxScore}</p>
                `;
                setTimeout(() => {
                    successMsg.style.display = 'block';
                    unlockNextExercise();
                    saveProgress();
                }, 600);
            } else if (errors.length === 0) {
                feedback.className = 'feedback-message warning';
                feedback.innerHTML = `
                    <h4><i class="fas fa-check-circle"></i> Good! Score: ${score}/${maxScore}</h4>
                    <p>Your form works. Improve these to get a perfect score:</p>
                    <ul>${warnings.map(w => `<li>${w}</li>`).join('')}</ul>
                `;
            } else {
                feedback.className = 'feedback-message warning';
                feedback.innerHTML = `
                    <h4><i class="fas fa-exclamation-triangle"></i> Needs work. Score: ${score}/${maxScore}</h4>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:18px;margin:12px 0;">
                        <div><strong>Errors:</strong><ul>${errors.map(e => `<li>${e}</li>`).join('')}</ul></div>
                        <div><strong>Suggestions:</strong><ul>${warnings.map(w => `<li>${w}</li>`).join('')}</ul></div>
                    </div>
                    <p>Fix errors first, then re-check.</p>
                `;
            }

            feedback.style.display = 'block';
            feedback.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function hideFeedback(){
            document.getElementById('feedbackMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        }

        function unlockNextExercise(){
            const nextBtn = document.getElementById('nextExerciseBtn');
            nextBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Exercise 3: Responsive Layout';
            nextBtn.style.opacity = '1';
            nextBtn.style.cursor = 'pointer';
            nextBtn.href = 'exercise3.html';
        }

        function goToNextExercise(e){
            e.preventDefault();
            if (localStorage.getItem('exercise2_completed') === 'true') {
                window.location.href = 'exercise3.html';
            }
        }

        function saveProgress(){
            localStorage.setItem('exercise2_completed', 'true');
            localStorage.setItem('exercise2_score', '25');
            let totalScore = parseInt(localStorage.getItem('total_score') || '0', 10);
            // Avoid double-count if already completed
            if (localStorage.getItem('exercise2_awarded') !== 'true') {
                totalScore += 25;
                localStorage.setItem('total_score', totalScore.toString());
                localStorage.setItem('exercise2_awarded', 'true');
            }
        }

        document.addEventListener('DOMContentLoaded', function(){
            const savedCode = localStorage.getItem('exercise2_code');
            document.getElementById('exerciseCode').value = savedCode || starterCode;
            runCode();

            if (localStorage.getItem('exercise2_completed') === 'true') {
                unlockNextExercise();
                document.getElementById('successMessage').style.display = 'block';
            }

            const codeEditor = document.getElementById('exerciseCode');
            codeEditor.addEventListener('input', function(){
                localStorage.setItem('exercise2_code', this.value);
            });

            codeEditor.addEventListener('keydown', function(e){
                if (e.key === 'Tab') {
                    e.preventDefault();
                    const start = this.selectionStart;
                    const end = this.selectionEnd;
                    this.value = this.value.substring(0, start) + '    ' + this.value.substring(end);
                    this.selectionStart = this.selectionEnd = start + 4;
                }
            });
        });
    </script>
</body>
</html>
